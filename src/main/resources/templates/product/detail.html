<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.springframework.org/schema/security"
      lang="en">
<head>
    <meta charset="UTF-8">
    <title>Detail Product</title>
    <th:block th:replace="@{layout/layoutClient} :: link-bootstrap"></th:block>
    <th:block th:replace="@{layout/layoutClient} :: link-main-css"></th:block>
    <th:block th:replace="@{layout/layoutClient} :: link-base-css"></th:block>
    <th:block th:replace="@{layout/layoutClient} :: link-font-css"></th:block>
    <th:block th:replace="@{layout/layoutClient} :: link-rob-css"></th:block>
    <th:block th:replace="@{layout/layoutClient} :: script-jquery"></th:block>
    <style>
        .btn-pink {
        background-color: pink;
        color: white;
        }
    </style>
</head>
<body class="app">
<th:block th:replace="@{layout/layoutClient} :: head_top"></th:block>
<!-- Messenger Plugin chat Code -->
<div id="fb-root"></div>

<!-- Your Plugin chat code -->
<div id="fb-customer-chat" class="fb-customerchat">
</div>

<script>
      var chatbox = document.getElementById('fb-customer-chat');
      chatbox.setAttribute("page_id", "106172929230177");
      chatbox.setAttribute("attribution", "biz_inbox");
    </script>

<!-- Your SDK code -->
<script>
      window.fbAsyncInit = function() {
        FB.init({
          xfbml            : true,
          version          : 'v17.0'
        });
      };

      (function(d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = 'https://connect.facebook.net/vi_VN/sdk/xfbml.customerchat.js';
        fjs.parentNode.insertBefore(js, fjs);
      }(document, 'script', 'facebook-jssdk'));
    </script>
<div class="app__container">
    <nav aria-label="breadcrumb " class="product" style="margin-top: -80px;">
        <ol class="breadcrumb mb-4">
            <li class="breadcrumb-item active"><a style="color: #000; text-decoration: none;" th:href="@{/}"><strong>Trang ch·ªß</strong></a></li>
            <li class="breadcrumb-item active"><a style="color: #000; text-decoration: none;" th:href="@{/address/show}" ><strong>C·ª≠a H√†ng</strong></a></li>
        </ol>
    </nav>
    <div class="row py-5 g-5 shadow" style="padding: 0px 210px 30px 210px;">
        <!-- image thumb -->
        <div class="col-12 col-lg-6 " style="margin-top: -80px;">
            <img th:src="${product.urlImageThumbnail}" class="m-1 w-100 sliderMainImage large-image" data-bs-toggle="model" data-bs-target="#imageModel"/>
            <ul class="list-group list-group-horizontal ">
                <li class="list-group-item border-0 ">
                    <img th:src="${product.urlImageThumbnail}" th:alt="hinh" width="60px" class="m-1 sliderThumb selected-image"/>
                </li>
                <li class="list-group-item border-0" th:each="image : ${product.imageList}">
                    <img th:src="${image}" th:alt="hinh" width="60px" class="m-1 sliderThumb"/>
                </li>
            </ul>
        </div>
        <div class="col-12 col-lg-6" style="margin-top: -0px;">
            <h2 id="productName"  th:text="${product.name}"></h2>
            <h4 class="my-4 product_price"><span  id="price" th:text="${product.price}"> </span></h4>
            <button class="like-button" onclick="toggleLike()">ü§ç Th√≠ch</button>
            <span class="like-count">0</span> Ng∆∞·ªùi th√≠ch
            <script>
                       const storedLikeCount = localStorage.getItem('likeCount');
            let likeCount = storedLikeCount ? parseInt(storedLikeCount) : 0;
            let isLiked = false;

            function toggleLike() {
              if (isLiked) {
                likeCount--;
              } else {
                likeCount++;
              }

              isLiked = !isLiked;
              updateUI();
              saveLikeCountToLocalStorage();
            }

            function updateUI() {
              const likeButton = document.querySelector('.like-button');
              const likeCountElement = document.querySelector('.like-count');

              likeButton.innerText = isLiked ? 'üíñ B·ªè th√≠ch' : 'ü§ç Th√≠ch';
              likeCountElement.innerText = likeCount;
            }

            function saveLikeCountToLocalStorage() {
              localStorage.setItem('likeCount', likeCount);
            }

            // C·∫≠p nh·∫≠t giao di·ªán ban ƒë·∫ßu
            updateUI();
            </script>
            <h4 class="my-4 "><span  id="cate" th:text="${product.productType.name +' - '+ product.category.name}"> </span></h4>
<!--            <td sec:authorize="hasAnyAuthority('ADMIN','USER')">-->
            <div class="d-grid my-4">
                <a th:href="@{/cart/add(id=${product.id},imageList=${product.urlImageThumbnail},name=${product.name},price=${product.price}, quantity=1)}" class="btn btn-lg btn-dark">
                    Th√™m v√†o gi·ªè h√†ng
                </a>
            </div>
            <div class="d-grid my-4">
                <form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post" target="_top">
                    <!-- V√≤ng l·∫∑p qua danh s√°ch s·∫£n ph·∫©m -->
                    <th:block th:each="productItem : ${product}">
                        <!-- M·ªói s·∫£n ph·∫©m c√≥ m·ªôt bi·ªÉu m·∫´u thanh to√°n ri√™ng -->
                        <input type="hidden" name="cmd" value="_xclick">
                        <input type="hidden" name="business" value="sb-ppqtc27424969@personal.example.com">
                        <input type="hidden" name="custom" th:value="${productItem.id}">
                        <input type="hidden" name="item_name" th:value="${productItem.name}">
                        <input type="hidden" name="amount" th:value="${productItem.price}">
                        <input type="hidden" name="currency_code" value="USD">
                        <input type="hidden" name="return" value="https://calculating-destruction-production.up.railway.app/product/products/">
                        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_buynow_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
                    </th:block>
                </form>
            </div>
<!--            </td>-->
            <div class="accordion">
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingTwo">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            <strong>M√¥ t·∫£</strong>
                        </button>
                    </h2>
                    <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne">
                        <div class="accordion-body text-truncate" th:text="${product.description}">
                        </div>
                    </div>
                </div>
            </div>
            <div class="d-grid my-4">
                <a th:href="@{/product/products}" class="btn btn-lg" style="background-color:linear-gradient(to right, #D2B48C, #D2B48C);">
                    Ti·∫øp t·ª•c mua s·∫Øm
                </a>
            </div>
        </div>
    </div>
</div>
<th:block th:replace="@{layout/layoutClient} :: footer"></th:block>
<script src="/js/toVND.js"></script>
</body>
</html>
<style>
    .selected-image {
        border: 2px solid whitesmoke; /* Thay ƒë·ªïi m√†u s·∫Øc v√† ƒë·ªô d√†y ƒë∆∞·ªùng vi·ªÅn t√πy √Ω */
        opacity: 0.5;
        transition: opacity 0.2s ease-in-out; /* Thay ƒë·ªïi m√†u s·∫Øc v√† ƒë·ªô m·ªù c·ªßa hi·ªáu ·ª©ng box-shadow t√πy √Ω */
    }
</style>
<script>
    // L·∫•y ph·∫ßn t·ª≠ h√¨nh ·∫£nh ch√≠nh
var mainImage = document.querySelector('.sliderMainImage');

// L·∫•y t·∫•t c·∫£ c√°c h√¨nh ·∫£nh thu nh·ªè
var thumbnailImages = document.querySelectorAll('.sliderThumb');

// L·∫∑p qua t·ª´ng h√¨nh ·∫£nh thu nh·ªè v√† th√™m m·ªôt tr√¨nh l·∫Øng nghe s·ª± ki·ªán click
thumbnailImages.forEach(function(thumbnailImage) {
    thumbnailImage.addEventListener('click', function(event) {
        // NgƒÉn ch·∫∑n h√†nh ƒë·ªông m·∫∑c ƒë·ªãnh c·ªßa li√™n k·∫øt
        event.preventDefault();

        // X√≥a l·ªõp CSS 'selected-image' kh·ªèi t·∫•t c·∫£ c√°c h√¨nh ·∫£nh thu nh·ªè
        thumbnailImages.forEach(function(image) {
            image.classList.remove('selected-image');
        });

        // Th√™m l·ªõp CSS 'selected-image' v√†o h√¨nh ·∫£nh thu nh·ªè ƒë∆∞·ª£c ch·ªçn
        this.classList.add('selected-image');

        // ƒê·∫∑t gi√° tr·ªã 'src' c·ªßa h√¨nh ·∫£nh ch√≠nh th√†nh gi√° tr·ªã 'src' c·ªßa h√¨nh ·∫£nh thu nh·ªè ƒë∆∞·ª£c ch·ªçn
        mainImage.setAttribute('src', this.getAttribute('src'));
    });
});
</script>
